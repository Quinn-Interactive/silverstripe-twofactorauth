---
Name: 2fa
After:
  - '#coresecurity'
---
SilverStripe\Security\Member:
  validated_activation_mode: true
  admins_can_disable: false
  totp_window: 2
  extensions:
    - _2fa\Extensions\Member
SilverStripe\Core\Injector\Injector:
  SilverStripe\Security\Security:
    properties:
      Authenticators:
        default: '%$_2fa\Authenticator'
  SilverStripe\Security\CMSSecurity:
    properties:
      Authenticators:
        cms: '%$_2fa\Authenticator'
  SilverStripe\Security\MemberLoginForm:
    class: _2fa\LoginForm
  SilverStripe\Security\ChangePasswordForm:
    class: _2fa\ChangePasswordForm
  SilverStripe\Security\CMSMemberLoginForm:
    class: _2fa\NonExistent
  SilverStripe\Admin\CMSProfileController:
    class: _2fa\CMSProfileController
SilverStripe\Security\CMSSecurity:
  reauth_enabled: false

LeftAndMain:
  extra_requirements_css:
    - twofactorauth/css/twofactorstyles.css
  extra_requirements_javascript:
    - twofactorauth/js/twofactorinteractions.js